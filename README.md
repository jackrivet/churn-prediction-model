# Customer Termination Risk Pipeline
An end-to-end churn risk prediction system built to support proactive outreach to at-risk customers. The pipeline pulls SQL Server data, trains a neural network, calibrates predictions, explains model behavior, and generates visual + tabular reports that are automatically emailed.

## Workflow Overview
- Pulls real-time data from MS SQL Server
- Builds a neural network using TensorFlow with SMOTE + feature scaling
- Calibrates with Isotonic Regression
- Explains outputs with SHAP (summary, force, waterfall plots)
- Exports results and visualizations
- Sends a fully automated routine email to stakeholders

## Sample Results

### Calibrated Probability Distribution
This plot shows the distribution of predicted churn probabilities across test accounts after model calibration using isotonic regression. The distribution demonstrates the model’s ability to distinguish varying levels of termination risk.

<img src="sample-results/density_plot 2025-05-28.png" alt="Calibrated Probability Plot" width="500"/>


### SHAP Summary Plot (Feature Importance)
This SHAP summary plot illustrates the top contributing features influencing the model’s predictions across all test data. Each point represents a SHAP value for a feature in one sample. This helps stakeholders understand what drives risk predictions.

<img src="sample-results/summary_plot 2025-05-28.png" alt="SHAP Summary Plot" width="500"/>

### SHAP Waterfall Plot (Single Sample Explanation)
This waterfall plot explains how feature values for one district influenced its high termination risk prediction. It shows how the model aggregated SHAP values to reach the final calibrated probability.

<img src="sample-results/waterfall_plot 2025-05-28.png" alt="SHAP Waterfall Plot" width="500"/>


### Interpretation
These plots are automatically generated by the pipeline and provide:
- Insight into the probability calibration of the model 
- A transparent view into what drives risk predictions 
- A visual audit trail to support strategic outreach

## Tech Stack
- **Python**: pandas, TensorFlow, pyodbc, matplotlib, shap, sklearn, imblearn
- **SQL Server**: Data source via pyodbc
- **Visualization**: SHAP, Matplotlib, Seaborn
- **Automation**: smtplib for email delivery

## How to Run
- Set up a `.env` file
- Run `run_pipeline.py` to execute the full workflow
- Note: This version excludes real credentials and data.
- **Evaluation Caveat:** 
This version of the model trains and tests on the same pulled dataset. It filters out terminated customers after scoring, which risks introducing leakage. In a future version, this will be addressed by scoring only on customers active at the time of inference and separating evaluation from calibration.
## Author
Jack Rivet – [LinkedIn](https://www.linkedin.com/in/jack-rivet-6a810a197)
